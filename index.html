<!DOCTYPE HTML>
<!--
	Fractal by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Compound Protocol Demo</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Header -->
			<header id="header">
				<div class="content">
					<h1><a href="#">Compound</a></h1>
					<p>Just a simple implementation of<br />
					Compound protocol</a></p>
					<ul class="actions">
						<li><a href="#supply" class="button icon solid fa-chevron-down scrolly">Supply</a></li>
						<li><a href="#borrow" class="button icon solid fa-chevron-down scrolly">Borrow</a></li>
					</ul>
				</div>
				<div class="image phone"><div class="inner"><img src="images/screen.jpg" alt="" /></div></div>
			</header>

		<!-- One -->
			<section id="supply" class="wrapper">
				<div class="inner alt">
					<section class="spotlight">						
							<ol>
								<li>
									<h3>Supply token to the Compound Protocol:</h3>
									<input type="text" id="supplyAmount" />
									<input type="submit" id="supplyButton" value="Supply" />
									<label id="supplyMsg"></label>
								</li>
								<li>
									<h3>Redeem from the Compound Protocol:</h3>
									<input type="text" id="redeemAmount" />
									<input type="submit" id="redeemButton" value="Redeem" />
									<label id="redeemMsg"></label>
								</li>

						  </ol>							  							  

					</section>								
				</div>
			</section>

		<!-- Two -->
			<section id="borrow" class="wrapper">
				<div class="inner alt">
					<section class="spotlight">
						<ol>
							<li>
								<h3>Enter market (Collateral from supply required):</h3>
								<input type="submit" id="enterButton" value="Enter Market" />
								<label id="enterMsg"></label>
							</li>

							<li>
								<h3>Borrow from the Compound Protocol:</h3>
								<input type="text" id="borrowAmount" />
								<input type="submit" id="borrowButton" value="Borrow" />
								<label id="borrowMsg"></label>
							</li>

							<li>
								<h3>Repay borrow:</h3>
								<input type="text" id="repayBorrowAmount" />
								<input type="submit" id="repayBorrowButton" value="Repay Borrow" />
								<label id="repayMsg"></label>
							</li>

						</ol>
					</section>
				</div>
			</section>


		<!-- Footer -->
			<footer id="footer">
				<ul class="icons">
					<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
					<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
					<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
				</ul>
				<p class="copyright">&copy; Untitled. Credits</p>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

			<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@compound-finance/compound-js@0.2.0/dist/browser/compound.min.js"></script>

			<script type="text/javascript">
			  

			  const supplyButton = document.getElementById('supplyButton');
			  const redeemButton = document.getElementById('redeemButton');
			  const enterButton = document.getElementById('enterButton');
			  const repayBorrowButton = document.getElementById('repayBorrowButton');

			  const provider = window.ethereum;
			  provider.enable().then(() => {
			    const compound = new Compound(provider);

			    const doEnter = async () => {			
			      const trx = await compound.enterMarkets(Compound.ETH); // Use [] for multiple
			      await trx.wait(1);
  					console.log('Ethers.js transaction object', trx);
			    };
			    enterButton.onclick = doEnter;


			    const doSupply = async () => {			
			      const tokenToSupply = document.getElementById('supplyAmount');
			      console.log('tokenToSupply', tokenToSupply);
			      const trx = await compound.supply(Compound.ETH, tokenToSupply.value);
			      document.getElementById('supplyMsg').innerHTML = 'Waiting for confirmation ...';
			      await trx.wait(1);				    
			      document.getElementById('supplyMsg').innerHTML = 'Supply success';
			      console.log('trx', trx);
			    };
			    supplyButton.onclick = doSupply;
				

			    const doRedeem = async () => {
			      const tokenToRedeem = document.getElementById('redeemAmount');
			      const trx = await compound.redeem(Compound.cETH, tokenToRedeem.value);
			      document.getElementById('redeemMsg').innerHTML = 'Waiting for confirmation ...';
			      await trx.wait(1);				    
			      document.getElementById('redeemMsg').innerHTML = 'Reedem success';
			      console.log('trx', trx);
			    };
			    redeemButton.onclick = doRedeem;
				

					const doBorrow = async () => {
			      const tokenToBorrow = document.getElementById('borrowAmount');
			      const trx = await compound.borrow(Compound.DAI, tokenToBorrow.value);
			      document.getElementById('borrowMsg').innerHTML = 'Waiting for confirmation ...';
			      await trx.wait(1);				    
			      document.getElementById('borrowMsg').innerHTML = 'Borrow success';
			      console.log('trx', trx);
			    };
			    borrowButton.onclick = doBorrow;

					const doRepayBorrow = async () => {
						const tokenToRepay = document.getElementById('repayBorrowAmount');						
					  const trx = await compound.repayBorrow(Compound.DAI, tokenToRepay.value, null);
			      document.getElementById('repayMsg').innerHTML = 'Waiting for confirmation ...';
			      await trx.wait(1);				    
			      document.getElementById('repayMsg').innerHTML = 'Repay Borrow success';
			      console.log('trx', trx);
			    };
			    repayBorrowButton.onclick = doRepayBorrow;
			    
			  });

			</script>

	</body>
</html>